<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://acebond.github.io/">
  <meta property="og:title" content="Adding Assembly (asm) Files to Visual Studio C/C&#43;&#43; Projects">
  <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
  <title>Adding Assembly (asm) Files to Visual Studio C/C&#43;&#43; Projects</title>
</head>
<body>
  <div class="container mx-auto px-2">
    <nav class="max-w-screen-lg my-10 mx-auto">
      <strong>
        <a href="/index.html">HOME</a>
      </strong>
    </nav>
    <article class="prose lg:prose-xl max-w-screen-lg my-10 mx-auto">
      <h1>Adding Assembly (asm) Files to Visual Studio C/C&#43;&#43; Projects</h1>
      <p><strong>0)</strong>
I have created an empty C/C++ project, added a single source file, and ensured my environment is working. This is the starting point.
<img src="/assets/img/2024-10-21/start.png" alt="Start"></p>
<p><strong>1)</strong>
Go <code>Project -&gt; Build Customization...</code>
<img src="/assets/img/2024-10-21/step1.png" alt="Step 1"></p>
<p><strong>2)</strong>
In the <code>Visual C++ Build Customization Files</code> window tick <code>masm(.targets, .props)</code> and click on <code>OK</code>.
<img src="/assets/img/2024-10-21/step2.png" alt="Step 2"></p>
<p><strong>3)</strong>
Right click <code>Source Files</code>, chose <code>Add</code>, then <code>New Item...</code>
<img src="/assets/img/2024-10-21/step3.png" alt="Step 3"></p>
<p><strong>4)</strong>
In the <code>Add New Item</code> dialog, select <code>C++ File (.cpp)</code>, and you <strong>MUST</strong> name the file with a <code>.asm</code> extension, then click <code>Add</code>.
<img src="/assets/img/2024-10-21/step4.png" alt="Step 4"></p>
<p><strong>5)</strong>
Write some asm code.
<img src="/assets/img/2024-10-21/step5.png" alt="Step 5"></p>
<p><strong>6)</strong>
Update <code>main.c</code> to call the new asm function.
<img src="/assets/img/2024-10-21/step6.png" alt="Step 6"></p>
<p><strong>7)</strong>
Everything should work.
<img src="/assets/img/2024-10-21/step7.png" alt="Step 7"></p>
<p><strong>8)</strong>
If you have issue, check the <code>.asm</code> file by right clicking, and going <code>Properties</code>.
<img src="/assets/img/2024-10-21/step8.png" alt="Step 8"></p>
<p><strong>9)</strong>
In the dialog, ensure <code>Item Type</code> is <code>Microsoft Macro Assembler</code> then click <code>OK</code>.
<img src="/assets/img/2024-10-21/step9.png" alt="Step 9"></p>

    </article>
  </div>
</body>
</html>